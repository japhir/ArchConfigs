## This file pulls solismail and syncs it to a local folder
## passwords are stored as encrypted files in my home directory

IMAPAccount solismail
# Address to connect to
Host outlook.office365.com
User i.j.kocken@uu.nl
# To store the password in an encrypted file use PassCmd instead of Pass
# To work with 2-factor authentication for Microsoft Office (work) account
# I've now installed the package oauth2ms from https://github.com/harishkrupo/oauth2ms locally
PassCmd /home/japhir/bin/oauth2ms
AuthMechs XOAUTH2

IMAPStore solismail-remote
Account solismail

MaildirStore solismail-local
# The trailing "/" is important
Path ~/Maildir/solismail/
Inbox ~/Maildir/solismail/inbox
SubFolders Verbatim

Channel solismail
Far :solismail-remote:
Near :solismail-local:
Patterns *
# Automatically create missing mailboxes, both locally and on the server
Create Both
# Automatically delete items on both IMAP and local
Expunge Both
# Save the synchronization state files in the relevant directory
SyncState *



# second account, work email gmail for ikocken@hawaii.edu
IMAPAccount hawaii
Host imap.gmail.com
User ikocken@hawaii.edu
PassCmd "cat ~/.hawaiipass"
AuthMechs LOGIN
SSLType IMAPS
CertificateFile /etc/ssl/certs/ca-certificates.crt

IMAPStore hawaii-remote
Account hawaii

MaildirStore hawaii-local
Subfolders Verbatim
Path ~/Maildir/hawaii/
Inbox ~/Maildir/hawaii/Inbox

# sync everything at once
# Channel hawaii
# Far :hawaii-remote:
# Near :hawaii-local:
# Patterns * ![Gmail]* "[Gmail]/Sent Mail" "[Gmail]/Starred" "[Gmail]/All Mail" "[Gmail]/Trash"
# Create Both
# Expunge Both
# SyncState *

# sync channel by channel so we can drop the [Gmail] prefix
# copied from: https://github.com/danielfleischer/mu4easy
Channel hawaii-inbox
Far :hawaii-remote:"INBOX"
Near :hawaii-local:"Inbox"
CopyArrivalDate yes
Create Both
Expunge Both
SyncState *

Channel hawaii-trash
Far :hawaii-remote:"[Gmail]/Trash"
Near :hawaii-local:"Trash"
CopyArrivalDate yes
Create Both
Expunge Both
SyncState *

Channel hawaii-spam
Far :hawaii-remote:"[Gmail]/Spam"
Near :hawaii-local:"Spam"
CopyArrivalDate yes
Create Both
Expunge Both
SyncState *

Channel hawaii-all
Far :hawaii-remote:"[Gmail]/All Mail"
Near :hawaii-local:"Archive"
CopyArrivalDate yes
Create Both
Expunge Both
SyncState *

# drafts often give sync issues...
# Channel hawaii-drafts
# Far :hawaii-remote:"[Gmail]/Drafts"
# Near :hawaii-local:"Drafts"
# CopyArrivalDate yes
# Create Both
# Expunge Both
# SyncState *

Group hawaii
Channel hawaii-inbox
Channel hawaii-trash
Channel hawaii-all
Channel hawaii-spam
# Channel hawaii-drafts
# note: no Sent items b/c they're in All Mail already!
